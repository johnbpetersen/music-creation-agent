var l=globalThis;var m=document.getElementById("music-form"),p=document.getElementById("prompt"),b=document.getElementById("seconds"),f=document.getElementById("pay-button"),y=document.getElementById("status"),g=document.getElementById("player");if(!m||!p||!b||!f||!y||!g)throw Error("UI elements missing");var i=y,c=f,h=g,u=p,d=b,o;function X(){if(o)return o;let t=l.__createX402Web??l.x402Web?.createX402Web;if(!t)throw Error("x402-web client unavailable");return o=t(),o}function E(t){let e=Number(t);if(!Number.isFinite(e))return NaN;return Math.floor(e)}async function v(t,e){i.textContent="Payingâ€¦",c.disabled=!0;try{let s=await X().fetch("/entrypoints/music/invoke",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({input:{prompt:t,seconds:e}})});if(!s.ok){let W=await s.text();throw Error(`Request failed: ${W}`)}let a=(await s.json())?.output?.trackUrl;if(typeof a!=="string"||!a)throw Error("Missing trackUrl in response");h.src=a,i.textContent="Ready! Press play."}catch(n){console.error("music ui error:",n),i.textContent=n instanceof Error?n.message:"Payment failed."}finally{c.disabled=!1}}function r(){let t=u.value.trim(),e=E(d.value),n=t.length>0&&Number.isInteger(e)&&e>=5&&e<=120;c.disabled=!n}u.addEventListener("input",r);d.addEventListener("input",r);r();m.addEventListener("submit",(t)=>{t.preventDefault();let e=u.value.trim(),n=E(d.value);if(e.length===0||!Number.isInteger(n))return;v(e,n)});l.__musicUi={validate:r};
