var c=globalThis;var p=document.getElementById("music-form"),b=document.getElementById("prompt"),f=document.getElementById("seconds"),y=document.getElementById("pay-button"),g=document.getElementById("status"),E=document.getElementById("player");if(!p||!b||!f||!y||!g||!E)throw Error("UI elements missing");var a=g,u=y,v=E,d=b,m=f,r,s;function W(){if(r)return Promise.resolve(r);if(s)return s;return s=new Promise((n)=>{let e=()=>{let t=c.__createX402Web??c.x402Web?.createX402Web;if(t){r=t(),n(r);return}setTimeout(e,50)};e()}),s}var h=!1;W().then(()=>{h=!0,o()}).catch((n)=>{console.error("music ui failed to load x402-web:",n),a.textContent="Wallet script failed to load. Refresh and try again."});function X(n){let e=Number(n);if(!Number.isFinite(e))return NaN;return Math.floor(e)}async function C(n,e){a.textContent="Payingâ€¦",u.disabled=!0;try{let i=await(await W()).fetch("/entrypoints/music/invoke",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({input:{prompt:n,seconds:e}})});if(!i.ok){let w=await i.text();throw Error(`Request failed: ${w}`)}let l=(await i.json())?.output?.trackUrl;if(typeof l!=="string"||!l)throw Error("Missing trackUrl in response");v.src=l,a.textContent="Ready! Press play."}catch(t){console.error("music ui error:",t),a.textContent=t instanceof Error?t.message:"Payment failed."}finally{u.disabled=!1}}function o(){let n=d.value.trim(),e=X(m.value),t=n.length>0&&Number.isInteger(e)&&e>=5&&e<=120&&h;u.disabled=!t}d.addEventListener("input",o);m.addEventListener("input",o);o();p.addEventListener("submit",(n)=>{n.preventDefault();let e=d.value.trim(),t=X(m.value);if(e.length===0||!Number.isInteger(t))return;C(e,t)});c.__musicUi={validate:o};
